{
	"info": {
		"_postman_id": "f14d2609-622f-4fa5-8f7d-2e2eb7798587",
		"name": "OHIP-Poly",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "49383169",
		"_collection_link": "https://pickmates-cuasibestia-646843.postman.co/workspace/Pick-Mates's-Workspace~7c0e2d31-e8a8-47f2-82c0-d516e8060d66/collection/49383169-f14d2609-622f-4fa5-8f7d-2e2eb7798587?action=share&source=collection_link&creator=49383169"
	},
	"item": [
		{
			"name": "Poly Config",
			"item": [
				{
					"name": "Initial Config",
					"item": [
						{
							"name": "Create Env Secrets",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"context\": \"ohip\",\n    \"name\": \"envSecrets\",\n    \"value\": {\n        \"ohip\": {\n            \"hostName\": \"{{HostName}}\",\n            \"hostNameDist\": \"{{HostNameDist}}\",\n            \"appKey\": \"{{AppKey}}\",\n            \"enterpriseId\": \"{{EnterpriseId}}\",\n            \"chainCode\": \"{{ChainCode}}\",\n            \"clientSecret\": \"{{CLIENT_SECRET}}\",\n            \"clientId\": \"{{CLIENT_ID}}\",\n            \"hotelId\": \"{{HotelId}}\"\n        },\n        \"google\": {\n            \"appKey\": \"{{GoogleMaps-AppKey}}\"\n        },\n        \"adyen\": {\n            \"hostName\": \"{{Adyen-HostName}}\",\n            \"appKey\": \"{{Adyen-AppKey}}\",\n            \"merchantAccount\": \"{{Adyen-MerchantAccount}}\"\n        }\n    },\n    \"description\": \"Environment variables for Oracle Hospitality custom server functions for OHIP\",\n    \"secret\": true,\n    \"visibility\": \"ENVIRONMENT\"\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/variables",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"variables"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "AI Guest Journey",
					"item": [
						{
							"name": "Create Env Settings (vari)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"context\": \"ohip\",\n    \"name\": \"envSettings\",\n    \"value\": {\n        \"opi\": false\n    },\n    \"description\": \"Environment settings\",\n    \"secret\": false,\n    \"visibility\": \"ENVIRONMENT\"\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/variables",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"variables"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create Env Descriptions For Model (vari)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"context\": \"ohip\",\n    \"name\": \"descriptionsForModel\",\n    \"value\": {\n        \"searchHotelAvailability\": [\n            \"Do not display ratePlanCode and roomTypeCode to the user\",\n            \"Display currency amounts in local currency\",\n            \"browserCountryCode and browserLocale should be based on the browser settings\",\n            \"Currency code should be ISO and based on the currency for the user country\"\n        ],\n        \"createResWithPayLink\" : {\n            \"linkMessage\" :{\n                \"messageToUser\": \"Open the secure link below to enter guest and payment details, then return here to tell me you've completed it. We will not complete the booking at this step. A small authorisation of 0.10 will be placed on your card. By submitting the form you give consent for us to store your payment details for processing at hotel check out.\",\n                \"instructionsForModel\" : \"Do not consider the booking as complete. Wait for the user to confirm they have completed the payment link step (for example, by saying 'done', 'completed', 'finished', or any equivalent confirmation). When they do, attempt the booking again and include the provided linkId so the payment details are linked to the reservation. Keep the same hotel and room selection unless the user changes them.\"\n            }\n        }\n    },\n    \"description\": \"Description for models to be used on custom function responses\",\n    \"secret\": false,\n    \"visibility\": \"ENVIRONMENT\"\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/variables/ee610e0a-a572-445d-b5f5-d251e65e5d18",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"variables",
										"ee610e0a-a572-445d-b5f5-d251e65e5d18"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create Pay Events Cache (tabi)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"paymentEventsCache\",\n  \"context\": \"ohip\",\n  \"description\": \"Store payments events for processing reservations\",\n  \"visibility\": \"ENVIRONMENT\",\n  \"columns\": [\n    {\n      \"name\": \"linkId\",\n      \"type\": \"string\",\n      \"required\": true,\n      \"unique\": true,\n      \"primary\": true\n    },\n    {\n      \"name\": \"event\",\n      \"type\": \"object\",\n      \"required\": true,\n      \"schema\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"additionalData\": {\n            \"type\": \"object\",\n            \"additionalProperties\": { \"type\": \"string\" }\n          },\n          \"amount\": {\n            \"type\": \"object\",\n            \"properties\": {\n              \"currency\": { \"type\": \"string\" },\n              \"value\": { \"type\": \"number\" }\n            },\n            \"required\": [\"currency\", \"value\"]\n          },\n          \"eventCode\": { \"type\": \"string\" },\n          \"eventDate\": { \"type\": \"string\" },\n          \"merchantAccountCode\": { \"type\": \"string\" },\n          \"merchantReference\": { \"type\": \"string\" },\n          \"operations\": {\n            \"type\": \"array\",\n            \"items\": { \"type\": \"string\" }\n          },\n          \"paymentMethod\": { \"type\": \"string\" },\n          \"pspReference\": { \"type\": \"string\" },\n          \"reason\": { \"type\": \"string\" },\n          \"success\": { \"type\": \"string\" }\n        },\n        \"required\": [\n          \"additionalData\",\n          \"amount\",\n          \"eventCode\",\n          \"eventDate\",\n          \"merchantAccountCode\",\n          \"merchantReference\",\n          \"operations\",\n          \"paymentMethod\",\n          \"pspReference\",\n          \"reason\",\n          \"success\"\n        ]\n      }\n    }\n  ]\n}\n",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/tables",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"tables"
									]
								}
							},
							"response": []
						},
						{
							"name": "Select From (tabi)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"where\": {}\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/tables/{{TabiId}}/select",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"tables",
										"{{TabiId}}",
										"select"
									]
								}
							},
							"response": []
						},
						{
							"name": "Prune Pay Events Cache (tabi)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"executionType\": \"sequential\",\n    \"functions\": [\n        {\n            \"id\": \"44cbab5e-fa16-49b7-b792-713862d5011e\",\n            \"eventPayload\": {},\n            \"headersPayload\": {},\n            \"paramsPayload\": {\n                \"olderThan\" : 168 // 2 weeks in hours\n            }\n        }\n    ],\n    \"name\": \"Prune Payment Events Cache\",\n    \"schedule\": {\n        \"type\": \"periodical\",\n        \"value\": \"*/5 * * * *\"\n    },\n    \"enabled\": true\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/jobs",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"jobs"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create Token Cache (tabi)",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"tokens\",\n  \"context\": \"ohip\",\n  \"description\": \"Token cache table\",\n//   \"ownerUserId\": \"\",\n  \"visibility\": \"ENVIRONMENT\",\n  \"columns\": [\n    {\n      \"name\": \"hashKey\",\n      \"type\": \"string\",\n      \"default\": \"\",\n      \"required\": true,\n      \"unique\": true,\n      \"primary\": true\n    },\n    {\n      \"name\": \"hostName\",\n      \"type\": \"string\",\n      \"default\": \"\",\n      \"required\": true,\n      \"unique\": false,\n      \"primary\": false\n    },\n    {\n      \"name\": \"enterpriseId\",\n      \"type\": \"string\",\n      \"default\": \"\",\n      \"required\": true,\n      \"unique\": false,\n      \"primary\": false\n    },\n    {\n      \"name\": \"chainCode\",\n      \"type\": \"string\",\n      \"default\": \"\",\n      \"required\": true,\n      \"unique\": false,\n      \"primary\": false\n    },\n    {\n      \"name\": \"scopes\",\n      \"type\": \"string\",\n      \"default\": \"\",\n      \"required\": false,\n      \"unique\": false,\n      \"primary\": false\n    },\n    {\n      \"name\": \"token\",\n      \"type\": \"string\",\n      \"default\": \"\",\n      \"required\": true,\n      \"unique\": false,\n      \"primary\": false\n    },\n    {\n      \"name\": \"expiry\",\n      \"type\": \"number\",\n      \"default\": 0,\n      \"required\": true,\n      \"unique\": false,\n      \"primary\": false\n    }\n  ]\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/tables",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"tables"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Custom Functions",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{Poly-Host}}/functions/server/",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"functions",
										"server",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Webhooks",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/webhooks/",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"webhooks",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Webhook Details",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/webhooks/{{Adyen-WebhoolUrl}}",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"webhooks",
										"{{Adyen-WebhoolUrl}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create Pay Hook Handler",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"source\": {\n    \"webhookHandleId\": \"81fcdebf-b6d0-4c71-9308-71ab3461262a\" //paymentEventHook\n  },\n  \"destination\": {\n    \"serverFunctionId\": \"40dae9a5-5141-4517-8d17-188aadc8a1c2\" //paymentEventServerHandler\n  },\n  \"waitForResponse\": true\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/triggers/",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"triggers",
										""
									]
								}
							},
							"response": []
						},
						{
							"name": "Create AI GX Assistant",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"slug\": \"OHIP\",\n  \"name\": \"AI Guest Experience for OHIP\",\n  \"descriptionForMarketplace\": \"A hotel assistant built with PolyAPI. Enables shop, book, check in and check out AI experiences\",\n  \"descriptionForModel\": \"userProvidedEmailAddress anduserProvidedPhoneNumber are mandatory fields and MUST be provided by the user and NOT determined by ChatGPT. The following elements are INTERNAL ONLY and must NOT be shown to the user: hotelId, ratePlanCode, roomTypeCode, currencyCode, browserCountryCode, browserLocale, countryCurrencyCode. Results from other plugins cannot be used as input for operations in this plugin. This plugin allows to seacrh hotel availability, book reservation, check-In a guest into the hotel, add packages like breakfast and even check out.\",\n  \"functionIds\": [\n    \"6fda3147-3482-4ddc-b958-3ad3a786901b\", // searchHotelsByLocation\n    \"9a3436e6-a992-4aab-a6a1-43e36020cd98\", // searchHotelAvailability\n    \"cc177a0a-8315-431b-99bb-6e301b24d400\", // createResWithPayLink\n    \"1a64161a-4690-4791-9bad-39bff55f3b7a\", // checkInGuest\n    \"eeb538cd-9089-4d27-b201-be8bb7a11718\", // getConciergeServices\n    \"97d3e7cb-b577-45fb-aa33-0cb2d2b31d3f\", // requestConciergeService\n    \"9a31e8eb-d06a-4258-bc50-76252bd3d42c\"  // checkBillCharges\n  ]\n}",
									"options": {
										"raw": {
											"headerFamily": "json",
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{Poly-Host}}/assistants",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"assistants"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create AI GX Assistant Spec",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{polyApiKey}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									},
									{
										"key": "Accept",
										"value": "application/json"
									}
								],
								"url": {
									"raw": "{{Poly-Host}}/assistants/ohip/openapi",
									"host": [
										"{{Poly-Host}}"
									],
									"path": [
										"assistants",
										"ohip",
										"openapi"
									]
								}
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "Collections For Training",
			"item": [
				{
					"name": "Authentication",
					"item": [
						{
							"name": "Get Property Token (With OCIM)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"var jsonData = pm.response.json();",
											"var accessToken = jsonData.access_token;",
											"pm.environment.set(\"Token\", accessToken);",
											"//Set other variables",
											"var moment = require('moment');",
											"pm.environment.set('DateFrom', moment().add(0, 'days').format((\"YYYY-MM-DD\")))",
											"pm.environment.set('DateTo', moment().add(1, 'days').format((\"YYYY-MM-DD\")))",
											"pm.environment.set('ArrivalTime', moment().add(0, 'days').format((\"YYYY-MM-DD HH:MM:SS\")))",
											"",
											"var uuid = require('uuid')",
											"randomId = uuid.v4()",
											"pm.environment.set('uuid',randomId)"
										],
										"type": "text/javascript",
										"packages": {},
										"requests": {}
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "{{CLIENT_SECRET}}",
											"type": "string"
										},
										{
											"key": "username",
											"value": "{{CLIENT_ID}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/x-www-form-urlencoded"
									},
									{
										"key": "x-app-key",
										"value": "{{AppKey}}"
									},
									{
										"key": "enterpriseId",
										"value": "{{EnterpriseId}}"
									}
								],
								"body": {
									"mode": "urlencoded",
									"urlencoded": [
										{
											"key": "grant_type",
											"value": "client_credentials",
											"type": "text"
										},
										{
											"key": "scope",
											"value": "urn:opc:hgbu:ws:__myscopes__",
											"type": "text"
										}
									]
								},
								"url": {
									"raw": "https://{{HostName}}/oauth/v1/tokens",
									"protocol": "https",
									"host": [
										"{{HostName}}"
									],
									"path": [
										"oauth",
										"v1",
										"tokens"
									]
								},
								"description": "Generated from cURL: curl --location '/oauth/v1/tokens' \\\n--header 'Content-Type: application/x-www-form-urlencoded' \\\n--header 'x-app-key;' \\\n--header 'enterpriseId: {{EnterpriseId}}' \\\n--header 'Authorization: ••••••' \\\n--data-urlencode 'grant_type=client_credentials' \\\n--data-urlencode 'scope=urn:opc:hgbu:ws:__myscopes__'"
							},
							"response": []
						}
					]
				},
				{
					"name": "AI Guest Journey",
					"item": [
						{
							"name": "Shop & Book",
							"item": [
								{
									"name": "Central (do not use. to be updated.)",
									"item": [
										{
											"name": "Shop Central Offers",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "Authorization",
														"value": "Bearer {{Token}}",
														"type": "text"
													},
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "Accept",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													},
													{
														"key": "x-channelCode",
														"value": "{{ChannelCode}}",
														"type": "text"
													}
												],
												"url": {
													"raw": "https://{{HostNameDist}}/shop/v1/hotels/{{HotelId}}/offers?adults={{Adults}}&numberOfUnits={{NumberOfUnits}}&arrivalDate={{DateFrom}}&departureDate={{DateTo}}&children={{Children}}&childrenAges={{ChildrenAges}}",
													"protocol": "https",
													"host": [
														"{{HostNameDist}}"
													],
													"path": [
														"shop",
														"v1",
														"hotels",
														"{{HotelId}}",
														"offers"
													],
													"query": [
														{
															"key": "adults",
															"value": "{{Adults}}"
														},
														{
															"key": "numberOfUnits",
															"value": "{{NumberOfUnits}}"
														},
														{
															"key": "arrivalDate",
															"value": "{{DateFrom}}"
														},
														{
															"key": "departureDate",
															"value": "{{DateTo}}"
														},
														{
															"key": "children",
															"value": "{{Children}}"
														},
														{
															"key": "childrenAges",
															"value": "{{ChildrenAges}}"
														}
													]
												},
												"description": "Get property offers for Public rates"
											},
											"response": []
										},
										{
											"name": "Get Central Shop Calendar",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															""
														],
														"type": "text/javascript"
													}
												},
												{
													"listen": "prerequest",
													"script": {
														"exec": [
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [
													{
														"key": "Authorization",
														"value": "Bearer {{Token}}",
														"type": "text"
													},
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "Accept",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													},
													{
														"key": "x-channelCode",
														"value": "{{channelCode}}",
														"type": "text"
													}
												],
												"url": {
													"raw": "https://{{HostNameDist}}/shop/v1/hotels/{{HotelId}}/calendar?arrivalDateFrom={{DateFrom}}&arrivalDateTo={{DateTo}}&adults={{Adults}}&children={{Children}}&childrenAges={{ChildrenAges}}&rateMode=Average&lengthOfStay=1",
													"protocol": "https",
													"host": [
														"{{HostNameDist}}"
													],
													"path": [
														"shop",
														"v1",
														"hotels",
														"{{HotelId}}",
														"calendar"
													],
													"query": [
														{
															"key": "arrivalDateFrom",
															"value": "{{DateFrom}}"
														},
														{
															"key": "arrivalDateTo",
															"value": "{{DateTo}}"
														},
														{
															"key": "adults",
															"value": "{{Adults}}"
														},
														{
															"key": "children",
															"value": "{{Children}}"
														},
														{
															"key": "childrenAges",
															"value": "{{ChildrenAges}}"
														},
														{
															"key": "rateMode",
															"value": "Average"
														},
														{
															"key": "lengthOfStay",
															"value": "1"
														}
													]
												},
												"description": "Get property offers for Public rates"
											},
											"response": []
										},
										{
											"name": "Create Central Reservation",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "POST",
												"header": [
													{
														"key": "Authorization",
														"value": "Bearer  {{Token}}",
														"type": "text"
													},
													{
														"key": "Content-Type",
														"value": "application/json; charset=utf-8",
														"type": "text"
													},
													{
														"key": "x-channelCode",
														"value": "{{channelCode}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													},
													{
														"key": "x-hdp-tracing-key",
														"value": "{{$guid}}",
														"type": "text",
														"disabled": true
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"reservations\": [\n        {\n            \"roomStay\": {\n                \"arrivalDate\": \"{{DateFrom}}\",\n                \"departureDate\": \"{{DateTo}}\",\n                \"roomRates\": [\n                    {\n                        \"guestCounts\": {\n                            \"adults\": {{Adults}},\n                            \"children\": {{Children}},\n                            \"childAges\": [{{ChildrenAges}}]\n                        },\n                        \"roomType\": \"{{RoomTypeCode}}\",\n                        \"ratePlanCode\": \"{{RatePlanCode}}\",\n                        \"numberOfUnits\": {{Units}},\n                        \"start\": \"{{DateFrom}}\",\n                        \"end\": \"{{DateTo}}\"\n                    }\n                ],\n                \"guarantee\": {\n                    \"guaranteeCode\": \"CC\"\n                },\n                \"printRate\": true\n            },\n            \"reservationPaymentMethods\": [\n                {\n                    \"paymentMethod\": \"5\",\n                    \"folioView\": \"1\",\n                    \"paymentCard\": {\n                        \"cardType\": \"AX\",\n                        \"cardNumber\": \"371449635398431\",\n                        \"expirationDate\": \"06/25\",\n                        \"cardHolderName\": \"SomeChannel VirtualCard\"\n                    }\n                }\n            ],\n            \"reservationGuests\": [\n                {\n                    \"profileInfo\": {\n                        \"profile\": {\n                            \"customer\": {\n                                \"personName\": [\n                                    {\n                                        \"surname\": \"{{GuestFirstName}}\",\n                                        \"givenName\": \"{{GuestLastName}}\",\n                                        \"nameTitle\": \"{{GuestTitle}}\",\n                                        \"nameType\": \"Primary\",\n                                        \"email\": \"{{GuestEmail}}\",\n                                        \"phoneNumber\": \"{{GuestPhoneNumber}}\",\n                                        \"address\": {\n                                            \"addressLine\": [\n                                                \"{{GuestAddressStreet}}\"\n                                            ],\n                                            \"cityName\": \"{{GuestAddressCity}}\",\n                                            \"postalCode\": \"{{GuestAddressPostalCode}}\",\n                                            \"country\": {\n                                                \"code\": \"{{GuestAddressCountry}}\"\n                                            },\n                                            \"state\": \"{{GuestAddressState}}\"\n                                        }\n                                    }\n                                ],\n                                \"language\": \"en-us\"\n                            },\n                            \"profileType\": \"Guest\"\n                        }\n                    },\n                    \"primary\": true\n                }\n            ],\n            \"hotelCode\": \"{{HotelId}}\",\n            \"messageId\": \"{{RandomUUID}}\"\n        }\n    ]\n}"
												},
												"url": {
													"raw": "https://{{HostNameDist}}/book/v1/hotels/{{HotelId}}/reservations",
													"protocol": "https",
													"host": [
														"{{HostNameDist}}"
													],
													"path": [
														"book",
														"v1",
														"hotels",
														"{{HotelId}}",
														"reservations"
													]
												},
												"description": "Sample wiht a single night with guest CC on folio 1"
											},
											"response": []
										},
										{
											"name": "Get Central Reservation",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															""
														],
														"type": "text/javascript"
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "Authorization",
														"value": "Bearer  {{Token}}",
														"type": "text"
													},
													{
														"key": "Content-Type",
														"value": "application/json; charset=utf-8",
														"type": "text"
													},
													{
														"key": "x-channelCode",
														"value": "{{channelCode}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													}
												],
												"url": {
													"raw": "https://{{HostNameDist}}/book/v1/hotels/{{HotelId}}/reservations/{{CentralReservationId}}",
													"protocol": "https",
													"host": [
														"{{HostNameDist}}"
													],
													"path": [
														"book",
														"v1",
														"hotels",
														"{{HotelId}}",
														"reservations",
														"{{CentralReservationId}}"
													]
												}
											},
											"response": []
										}
									]
								},
								{
									"name": "Property",
									"item": [
										{
											"name": "List All Properties",
											"protocolProfileBehavior": {
												"disableBodyPruning": true
											},
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-hotelid",
														"value": "{{HotelId}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "https://{{HostName}}/lov/v1/listOfValues/ResortChains",
													"protocol": "https",
													"host": [
														"{{HostName}}"
													],
													"path": [
														"lov",
														"v1",
														"listOfValues",
														"ResortChains"
													]
												},
												"description": "List the hotels in the chain being accessed.\n\nContext:  \npoly.ohip.property.getAllHotelsInChain"
											},
											"response": []
										},
										{
											"name": "Get Property Details",
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													},
													{
														"key": "x-hotelid",
														"value": "{{HotelId}}",
														"type": "text"
													}
												],
												"url": {
													"raw": "https://{{HostName}}/ent/config/v1/hotels/{{HotelId}}?fetchInstructions=General&fetchInstructions=GeneralNotes",
													"protocol": "https",
													"host": [
														"{{HostName}}"
													],
													"path": [
														"ent",
														"config",
														"v1",
														"hotels",
														"{{HotelId}}"
													],
													"query": [
														{
															"key": "fetchInstructions",
															"value": "General"
														},
														{
															"key": "fetchInstructions",
															"value": "GeneralNotes"
														}
													]
												},
												"description": "Context:  \npoly.ohip.property.getHotelDetails"
											},
											"response": []
										},
										{
											"name": "Distance To Hotels",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															"var jsonData = null;",
															"",
															"try {",
															"    jsonData = pm.response.json();",
															"    pm.test(\"Check if response is valid JSON\", function() {    ",
															"    pm.expect(jsonData).to.be.an('object');",
															"    pm.visualizer.set(`<textarea style=\"width: 100vw; height: 100vh; font-family: monospace;\">${pm.response.json().choices[0].message.content}</textarea>`);",
															"});",
															"} catch (a) {",
															"    console.log(\"Dealing with an SSE stream ... \")",
															"}"
														],
														"type": "text/javascript",
														"packages": {},
														"requests": {}
													}
												}
											],
											"request": {
												"method": "GET",
												"header": [],
												"url": {
													"raw": "https://maps.googleapis.com/maps/api/distancematrix/json?key={{GoogleMaps-AppKey}}&units={{DistanceMetric}}&origins={{HotelAddresses}}&destinations={{HotelDestination}}&language={{DistanceLang}}&mode={{DistanceMode}}",
													"protocol": "https",
													"host": [
														"maps",
														"googleapis",
														"com"
													],
													"path": [
														"maps",
														"api",
														"distancematrix",
														"json"
													],
													"query": [
														{
															"key": "key",
															"value": "{{GoogleMaps-AppKey}}"
														},
														{
															"key": "units",
															"value": "{{DistanceMetric}}"
														},
														{
															"key": "origins",
															"value": "{{HotelAddresses}}"
														},
														{
															"key": "destinations",
															"value": "{{HotelDestination}}"
														},
														{
															"key": "language",
															"value": "{{DistanceLang}}"
														},
														{
															"key": "mode",
															"value": "{{DistanceMode}}"
														}
													]
												},
												"description": "Context:  \npoly.google.maps.distanceToHotels"
											},
											"response": []
										},
										{
											"name": "Get Property Room Types",
											"protocolProfileBehavior": {
												"disableBodyPruning": true
											},
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-hotelid",
														"value": "{{HotelId}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "https://{{HostName}}/lov/v1/listOfValues/hotels/{{HotelId}}/resortRoomTypes",
													"protocol": "https",
													"host": [
														"{{HostName}}"
													],
													"path": [
														"lov",
														"v1",
														"listOfValues",
														"hotels",
														"{{HotelId}}",
														"resortRoomTypes"
													]
												},
												"description": "Context:\n\npoly.ohip.property.getPropertyRoomTypes"
											},
											"response": []
										},
										{
											"name": "Search Property Availability",
											"event": [
												{
													"listen": "prerequest",
													"script": {
														"exec": [
															""
														],
														"type": "text/javascript",
														"packages": {},
														"requests": {}
													}
												}
											],
											"protocolProfileBehavior": {
												"disableBodyPruning": true
											},
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-hotelid",
														"value": "{{HotelId}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "https://{{HostName}}/par/v1/hotels/{{HotelId}}/availability?roomStayStartDate={{DateFrom}}&children={{Children}}&adults={{Adults}}&roomStayQuantity={{NumberOfUnits}}&roomType={{RoomTypeCode}}&roomStayEndDate={{DateTo}}",
													"protocol": "https",
													"host": [
														"{{HostName}}"
													],
													"path": [
														"par",
														"v1",
														"hotels",
														"{{HotelId}}",
														"availability"
													],
													"query": [
														{
															"key": "childAge",
															"value": "{{ChildrenAges}}",
															"disabled": true
														},
														{
															"key": "ratePlanCode",
															"value": "{{RatePlanCode}}",
															"description": "optional",
															"disabled": true
														},
														{
															"key": "includeClosedRates",
															"value": "",
															"disabled": true
														},
														{
															"key": "includeDefaultRatePlanSet",
															"value": "",
															"disabled": true
														},
														{
															"key": "initialRatePlanSet",
															"value": "",
															"disabled": true
														},
														{
															"key": "ratePlanSet",
															"value": "",
															"disabled": true
														},
														{
															"key": "pagePointerKey",
															"value": "",
															"disabled": true
														},
														{
															"key": "bucket1Count",
															"value": "",
															"disabled": true
														},
														{
															"key": "bucket2Count",
															"value": "",
															"disabled": true
														},
														{
															"key": "bucket3Count",
															"value": "",
															"disabled": true
														},
														{
															"key": "bucket4Count",
															"value": "",
															"disabled": true
														},
														{
															"key": "bucket5Count",
															"value": "",
															"disabled": true
														},
														{
															"key": "fullStayTimeSpanStartDate",
															"value": "",
															"disabled": true
														},
														{
															"key": "fullStayTimeSpanEndDate",
															"value": "",
															"disabled": true
														},
														{
															"key": "prevailingRate",
															"value": "",
															"disabled": true
														},
														{
															"key": "rateCategory",
															"value": "",
															"disabled": true
														},
														{
															"key": "rateClass",
															"value": "",
															"disabled": true
														},
														{
															"key": "rateGroup",
															"value": "",
															"disabled": true
														},
														{
															"key": "feature",
															"value": "",
															"disabled": true
														},
														{
															"key": "reservationGuestId",
															"value": "",
															"disabled": true
														},
														{
															"key": "reservationGuestIdType",
															"value": "",
															"disabled": true
														},
														{
															"key": "hotelReservationId",
															"value": "",
															"disabled": true
														},
														{
															"key": "hotelReservationIdType",
															"value": "",
															"disabled": true
														},
														{
															"key": "ratePlanInfo",
															"value": "",
															"disabled": true
														},
														{
															"key": "returnOnlyAvailableRateCodes",
															"value": "",
															"disabled": true
														},
														{
															"key": "resGuaranteeInfo",
															"value": "",
															"disabled": true
														},
														{
															"key": "roomTypeInfo",
															"value": "",
															"disabled": true
														},
														{
															"key": "membershipIdNumber",
															"value": "",
															"disabled": true
														},
														{
															"key": "smokingPreference",
															"value": "",
															"disabled": true
														},
														{
															"key": "roomStayStartDate",
															"value": "{{DateFrom}}"
														},
														{
															"key": "children",
															"value": "{{Children}}"
														},
														{
															"key": "adults",
															"value": "{{Adults}}"
														},
														{
															"key": "roomStayQuantity",
															"value": "{{NumberOfUnits}}"
														},
														{
															"key": "roomType",
															"value": "{{RoomTypeCode}}"
														},
														{
															"key": "roomStayEndDate",
															"value": "{{DateTo}}"
														}
													]
												},
												"description": "Context:  \nohip.property.searchHotelAvailability"
											},
											"response": []
										},
										{
											"name": "Create Property Reservation",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															"// Extract ReservationId from the Location header\r",
															"var data = pm.response.headers.get(\"Location\").split(\"/\").pop();\r",
															"pm.environment.set(\"ReservationId\", data);\r",
															"\r",
															"// Parse response body to JSON\r",
															"var jsonData = pm.response.json();\r",
															"\r",
															"// Find link that contains confirmationNumberList\r",
															"var confirmationLink = jsonData.links.find(link => link.href.includes(\"confirmationNumberList\"));\r",
															"\r",
															"// If found, extract and set ConfirmationNumber\r",
															"if (confirmationLink) {\r",
															"    var confirmationNumber = confirmationLink.href.split(\"confirmationNumberList=\")[1];\r",
															"    pm.environment.set(\"ConfirmationNumber\", confirmationNumber);\r",
															"}\r",
															""
														],
														"type": "text/javascript",
														"packages": {},
														"requests": {}
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-hotelid",
														"value": "{{HotelId}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\r\n    \"reservations\": {\r\n        \"reservation\": [\r\n            {\r\n                \"sourceOfSale\": {\r\n                    \"sourceType\": \"PMS\",\r\n                    \"sourceCode\": \"{{HotelId}}\"\r\n                },\r\n                \"roomStay\": {\r\n                    \"roomRates\": [\r\n                        {\r\n                            \"total\": {\r\n                                \"amountBeforeTax\": \"{{AmountBeforeTax}}\"\r\n                            },\r\n                            \"rates\": {\r\n                                \"rate\": [\r\n                                    {\r\n                                        \"base\": {\r\n                                            \"amountBeforeTax\": \"{{AmountBeforeTax}}\",\r\n                                            \"currencyCode\": \"{{CurrencyCode}}\"\r\n                                        },\r\n                                        \"shareDistributionInstruction\": \"Full\",\r\n                                        \"total\": {\r\n                                            \"amountBeforeTax\": \"{{AmountBeforeTax}}\"\r\n                                        },\r\n                                        \"start\": \"{{DateFrom}}\",\r\n                                        \"end\": \"{{DateTo}}\"\r\n                                    }\r\n                                ]\r\n                            },\r\n                            \"guestCounts\": {\r\n                                \"adults\": \"{{Adults}}\"\r\n                                ,\"children\": \"{{Children}}\"\r\n                                ,\"childAges\": {{ChildrenAges}}\r\n                            },\r\n                            \"roomType\": \"{{RoomTypeCode}}\",\r\n                            \"ratePlanCode\": \"{{RatePlanCode}}\",\r\n                            \"start\": \"{{DateFrom}}\",\r\n                            \"end\": \"{{DateTo}}\",\r\n                            \"suppressRate\": true,\r\n                            \"marketCode\": \"LEISURE\",\r\n                            \"marketCodeDescription\": \"Leisure\",\r\n                            \"sourceCode\": \"WEB\",\r\n                            \"sourceCodeDescription\": \"Website\",\r\n                            \"numberOfUnits\": \"{{NumberOfUnits}}\",\r\n                            \"pseudoRoom\": false,\r\n                            \"roomTypeCharged\": \"{{RoomTypeCode}}\",\r\n                            \"houseUseOnly\": false,\r\n                            \"complimentary\": false,\r\n                            \"fixedRate\": true,\r\n                            \"discountAllowed\": false,\r\n                            \"bogoDiscount\": false\r\n                        }\r\n                    ],\r\n                    \"arrivalDate\": \"{{DateFrom}}\",\r\n                    \"departureDate\": \"{{DateTo}}\",\r\n                    \"guarantee\": {\r\n                        \"guaranteeCode\": \"CC\",\r\n                        \"shortDescription\": \"Guaranteed by Credit Card\"\r\n                    },\r\n                    \"roomNumberLocked\": false,\r\n                    \"printRate\": false\r\n                },\r\n                \"reservationGuests\": [\r\n                    {\r\n                        \"profileInfo\": {\r\n                            \"profile\": {\r\n                                \"customer\": {\r\n                                    \"personName\": [\r\n                                        {\r\n                                            \"givenName\": \"{{GuestFirstName}}\",\r\n                                            \"middleName\": \"\",\r\n                                            \"surname\": \"{{GuestLastName}}\",\r\n                                            \"nameType\": \"Primary\"\r\n                                        }\r\n                                    ],\r\n                                    \"language\": \"E\"\r\n                                },\r\n                                \"addresses\": {\r\n                                    \"addressInfo\": [\r\n                                        {\r\n                                            \"address\": {\r\n                                                \"addressLine\": [\r\n                                                    \"{{GuestHouseNameOrNumber}}\",\r\n                                                    \"{{GuestAddressStreet}}\"\r\n                                                ],\r\n                                                \"cityName\": \"{{GuestAddressCity}}\",\r\n                                                \"postalCode\": \"{{GuestAddressPostalCode}}\",\r\n                                                \"state\": \"{{GuestAddressState}}\",\r\n                                                \"country\": {\r\n                                                    \"value\": \"{{GuestAddressCountry}}\",\r\n                                                    \"code\": \"{{GuestAddressCountry}}\"\r\n                                                },\r\n                                                \"language\": \"EN\",\r\n                                                \"type\": \"HOME\",\r\n                                                \"primaryInd\": true\r\n                                            }\r\n                                        }\r\n                                    ]\r\n                                },\r\n                                \"emails\": {\r\n                                    \"emailInfo\": [\r\n                                        {\r\n                                            \"email\": {\r\n                                                \"emailAddress\": \"{{GuestEmail}}\",\r\n                                                \"type\": \"EMAIL\",\r\n                                                \"typeDescription\": \"Email Address\",\r\n                                                \"primaryInd\": true\r\n                                            }\r\n                                        }\r\n                                    ]\r\n                                },\r\n                                \"profileType\": \"Guest\"\r\n                            }\r\n                        },\r\n                        \"primary\": true\r\n                    }\r\n                ],\r\n                \"reservationPaymentMethods\": [\r\n                    {\r\n                        \"paymentMethod\": \"CA\",\r\n                        \"folioView\": \"1\"\r\n                    }\r\n                ],\r\n                \"hotelId\": \"{{HotelId}}\",\r\n                \"roomStayReservation\": true,\r\n                \"reservationStatus\": \"Reserved\",\r\n                \"computedReservationStatus\": \"DueIn\",\r\n                \"walkIn\": false,\r\n                \"printRate\": false,\r\n                \"preRegistered\": false,\r\n                \"upgradeEligible\": false,\r\n                \"allowAutoCheckin\": false,\r\n                \"hasOpenFolio\": false,\r\n                \"allowMobileCheckout\": false,\r\n                \"allowMobileViewFolio\": false,\r\n                \"allowPreRegistration\": false,\r\n                \"optedForCommunication\": false\r\n            }\r\n        ]\r\n    }\r\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "https://{{HostName}}/rsv/v1/hotels/{{HotelId}}/reservations",
													"protocol": "https",
													"host": [
														"{{HostName}}"
													],
													"path": [
														"rsv",
														"v1",
														"hotels",
														"{{HotelId}}",
														"reservations"
													]
												},
												"description": "Context:\n\nohip.property.createReservation"
											},
											"response": []
										},
										{
											"name": "Create Property Reservation With Token",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															"// Extract ReservationId from the Location header\r",
															"var data = pm.response.headers.get(\"Location\").split(\"/\").pop();\r",
															"pm.environment.set(\"ReservationId\", data);\r",
															"\r",
															"// Parse response body to JSON\r",
															"var jsonData = pm.response.json();\r",
															"\r",
															"// Find link that contains confirmationNumberList\r",
															"var confirmationLink = jsonData.links.find(link => link.href.includes(\"confirmationNumberList\"));\r",
															"\r",
															"// If found, extract and set ConfirmationNumber\r",
															"if (confirmationLink) {\r",
															"    var confirmationNumber = confirmationLink.href.split(\"confirmationNumberList=\")[1];\r",
															"    pm.environment.set(\"ConfirmationNumber\", confirmationNumber);\r",
															"}\r",
															""
														],
														"type": "text/javascript",
														"packages": {},
														"requests": {}
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-hotelid",
														"value": "{{HotelId}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\r\n    \"reservations\": {\r\n        \"reservation\": [\r\n            {\r\n                \"sourceOfSale\": {\r\n                    \"sourceType\": \"PMS\",\r\n                    \"sourceCode\": \"{{HotelId}}\"\r\n                },\r\n                \"roomStay\": {\r\n                    \"roomRates\": [\r\n                        {\r\n                            \"total\": {\r\n                                \"amountBeforeTax\": \"{{AmountBeforeTax}}\"\r\n                            },\r\n                            \"rates\": {\r\n                                \"rate\": [\r\n                                    {\r\n                                        \"base\": {\r\n                                            \"amountBeforeTax\": \"{{AmountBeforeTax}}\",\r\n                                            \"currencyCode\": \"{{CurrencyCode}}\"\r\n                                        },\r\n                                        \"shareDistributionInstruction\": \"Full\",\r\n                                        \"total\": {\r\n                                            \"amountBeforeTax\": \"{{AmountBeforeTax}}\"\r\n                                        },\r\n                                        \"start\": \"{{DateFrom}}\",\r\n                                        \"end\": \"{{DateTo}}\"\r\n                                    }\r\n                                ]\r\n                            },\r\n                            \"guestCounts\": {\r\n                                \"adults\": \"{{Adults}}\",\r\n                                \"children\": \"{{Children}}\",\r\n                                \"childAges\": {{ChildrenAges}}\r\n                            },\r\n                            \"roomType\": \"{{RoomTypeCode}}\",\r\n                            \"ratePlanCode\": \"{{RatePlanCode}}\",\r\n                            \"start\": \"{{DateFrom}}\",\r\n                            \"end\": \"{{DateTo}}\",\r\n                            \"suppressRate\": true,\r\n                            \"marketCode\": \"LEISURE\",\r\n                            \"marketCodeDescription\": \"Leisure\",\r\n                            \"sourceCode\": \"WEB\",\r\n                            \"sourceCodeDescription\": \"Website\",\r\n                            \"numberOfUnits\": \"{{NumberOfUnits}}\",\r\n                            \"pseudoRoom\": false,\r\n                            \"roomTypeCharged\": \"{{RoomTypeCode}}\",\r\n                            \"houseUseOnly\": false,\r\n                            \"complimentary\": false,\r\n                            \"fixedRate\": true,\r\n                            \"discountAllowed\": false,\r\n                            \"bogoDiscount\": false\r\n                        }\r\n                    ],\r\n                    \"arrivalDate\": \"{{DateFrom}}\",\r\n                    \"departureDate\": \"{{DateTo}}\",\r\n                    \"guarantee\": {\r\n                        \"guaranteeCode\": \"CC\",\r\n                        \"shortDescription\": \"Guaranteed by Credit Card\"\r\n                    },\r\n                    \"roomNumberLocked\": false,\r\n                    \"printRate\": false\r\n                },\r\n                \"reservationGuests\": [\r\n                    {\r\n                        \"profileInfo\": {\r\n                            \"profile\": {\r\n                                \"customer\": {\r\n                                    \"personName\": [\r\n                                        {\r\n                                            \"givenName\": \"{{GuestFirstName}}\",\r\n                                            \"middleName\": \"\",\r\n                                            \"surname\": \"{{GuestLastName}}\",\r\n                                            \"nameType\": \"Primary\"\r\n                                        }\r\n                                    ],\r\n                                    \"language\": \"E\"\r\n                                },\r\n                                \"addresses\": {\r\n                                    \"addressInfo\": [\r\n                                        {\r\n                                            \"address\": {\r\n                                                \"addressLine\": [\r\n                                                    \"{{GuestHouseNameOrNumber}}\",\r\n                                                    \"{{GuestAddressStreet}}\"\r\n                                                ],\r\n                                                \"cityName\": \"{{GuestAddressCity}}\",\r\n                                                \"postalCode\": \"{{GuestAddressPostalCode}}\",\r\n                                                \"state\": \"{{GuestAddressState}}\",\r\n                                                \"country\": {\r\n                                                    \"value\": \"{{GuestAddressCountry}}\",\r\n                                                    \"code\": \"{{GuestAddressCountry}}\"\r\n                                                },\r\n                                                \"language\": \"EN\",\r\n                                                \"type\": \"HOME\",\r\n                                                \"primaryInd\": true\r\n                                            }\r\n                                        }\r\n                                    ]\r\n                                },\r\n                                \"emails\": {\r\n                                    \"emailInfo\": [\r\n                                        {\r\n                                            \"email\": {\r\n                                                \"emailAddress\": \"{{GuestEmail}}\",\r\n                                                \"type\": \"EMAIL\",\r\n                                                \"typeDescription\": \"Email Address\",\r\n                                                \"primaryInd\": true\r\n                                            }\r\n                                        }\r\n                                    ]\r\n                                },\r\n                                \"telephones\": {\r\n                                    \"telephoneInfo\": [\r\n                                        {\r\n                                            \"telephone\": {\r\n                                                \"phoneTechType\": \"PHONE\",\r\n                                                \"phoneUseType\": \"MOBILE\",\r\n                                                \"phoneUseTypeDescription\": \"Mobile Phone Number\",\r\n                                                \"phoneNumber\": \"{{GuestPhoneNumber}}\",\r\n                                                \"primaryInd\": true,\r\n                                                \"orderSequence\": \"1\"\r\n                                            }\r\n                                        }\r\n                                    ]\r\n                                },\r\n                                \"profileType\": \"Guest\"\r\n                            }\r\n                        },\r\n                        \"primary\": true\r\n                    }\r\n                ],\r\n                \"reservationPaymentMethods\": [\r\n                    {\r\n                        \"paymentCard\": {\r\n                            \"cardType\": \"{{CardType}}\",\r\n                            \"cardNumber\": \"{{PaymentToken}}\",\r\n                            \"cardNumberMasked\": \"XXXXXXXXXXXX{{Last4Digits}}\",\r\n                            \"expirationDate\": \"20{{ExpiryYY-MM}}-00\",\r\n                            \"cardHolderName\": \"{{NameOnCard}}\",\r\n                            \"cardOrToken\": \"Token\",\r\n                            \"processing\": \"Manual\",\r\n                            \"swiped\": false,\r\n                            \"citId\": {{citId}}\r\n                        },\r\n                        \"authorizationRule\": {\r\n                            \"code\": \"2\" //Authorise amount for stay or deposit\r\n                        },\r\n                        \"paymentMethod\": \"{{CardType}}\",\r\n                        \"description\": \"Card token\",\r\n                        \"folioView\": \"1\"\r\n                    }\r\n                ],\r\n                \"hotelId\": \"{{HotelId}}\",\r\n                \"roomStayReservation\": true,\r\n                \"reservationStatus\": \"Reserved\",\r\n                \"computedReservationStatus\": \"DueIn\",\r\n                \"walkIn\": false,\r\n                \"printRate\": false,\r\n                \"preRegistered\": false,\r\n                \"upgradeEligible\": false,\r\n                \"allowAutoCheckin\": false,\r\n                \"hasOpenFolio\": false,\r\n                \"allowMobileCheckout\": false,\r\n                \"allowMobileViewFolio\": false,\r\n                \"allowPreRegistration\": false,\r\n                \"optedForCommunication\": false\r\n            }\r\n        ]\r\n    }\r\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "https://{{HostName}}/rsv/v1/hotels/{{HotelId}}/reservations",
													"protocol": "https",
													"host": [
														"{{HostName}}"
													],
													"path": [
														"rsv",
														"v1",
														"hotels",
														"{{HotelId}}",
														"reservations"
													]
												},
												"description": "Context:\n\nohip.property.createReservationWithToken"
											},
											"response": []
										},
										{
											"name": "Create Property Reservation With Token And Profile Id",
											"event": [
												{
													"listen": "test",
													"script": {
														"exec": [
															"// Extract ReservationId from the Location header\r",
															"var data = pm.response.headers.get(\"Location\").split(\"/\").pop();\r",
															"pm.environment.set(\"ReservationId\", data);\r",
															"\r",
															"// Parse response body to JSON\r",
															"var jsonData = pm.response.json();\r",
															"\r",
															"// Find link that contains confirmationNumberList\r",
															"var confirmationLink = jsonData.links.find(link => link.href.includes(\"confirmationNumberList\"));\r",
															"\r",
															"// If found, extract and set ConfirmationNumber\r",
															"if (confirmationLink) {\r",
															"    var confirmationNumber = confirmationLink.href.split(\"confirmationNumberList=\")[1];\r",
															"    pm.environment.set(\"ConfirmationNumber\", confirmationNumber);\r",
															"}\r",
															""
														],
														"type": "text/javascript",
														"packages": {},
														"requests": {}
													}
												}
											],
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "POST",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-hotelid",
														"value": "{{HotelId}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "{\r\n    \"reservations\": {\r\n        \"reservation\": [\r\n            {\r\n                \"sourceOfSale\": {\r\n                    \"sourceType\": \"PMS\",\r\n                    \"sourceCode\": \"{{HotelId}}\"\r\n                },\r\n                \"roomStay\": {\r\n                    \"roomRates\": [\r\n                        {\r\n                            \"total\": {\r\n                                \"amountBeforeTax\": \"{{AmountBeforeTax}}\"\r\n                            },\r\n                            \"rates\": {\r\n                                \"rate\": [\r\n                                    {\r\n                                        \"base\": {\r\n                                            \"amountBeforeTax\": \"{{AmountBeforeTax}}\",\r\n                                            \"currencyCode\": \"{{CurrencyCode}}\"\r\n                                        },\r\n                                        \"shareDistributionInstruction\": \"Full\",\r\n                                        \"total\": {\r\n                                            \"amountBeforeTax\": \"{{AmountBeforeTax}}\"\r\n                                        },\r\n                                        \"start\": \"{{DateFrom}}\",\r\n                                        \"end\": \"{{DateTo}}\"\r\n                                    }\r\n                                ]\r\n                            },\r\n                            \"guestCounts\": {\r\n                                \"adults\": \"{{Adults}}\",\r\n                                \"children\": \"{{Children}}\",\r\n                                \"childAges\": {{ChildrenAges}}\r\n                            },\r\n                            \"roomType\": \"{{RoomTypeCode}}\",\r\n                            \"ratePlanCode\": \"{{RatePlanCode}}\",\r\n                            \"start\": \"{{DateFrom}}\",\r\n                            \"end\": \"{{DateTo}}\",\r\n                            \"suppressRate\": true,\r\n                            \"marketCode\": \"LEISURE\",\r\n                            \"marketCodeDescription\": \"Leisure\",\r\n                            \"sourceCode\": \"WEB\",\r\n                            \"sourceCodeDescription\": \"Website\",\r\n                            \"numberOfUnits\": \"{{NumberOfUnits}}\",\r\n                            \"pseudoRoom\": false,\r\n                            \"roomTypeCharged\": \"{{RoomTypeCode}}\",\r\n                            \"houseUseOnly\": false,\r\n                            \"complimentary\": false,\r\n                            \"fixedRate\": true,\r\n                            \"discountAllowed\": false,\r\n                            \"bogoDiscount\": false\r\n                        }\r\n                    ],\r\n                    \"arrivalDate\": \"{{DateFrom}}\",\r\n                    \"departureDate\": \"{{DateTo}}\",\r\n                    \"guarantee\": {\r\n                        \"guaranteeCode\": \"CC\",\r\n                        \"shortDescription\": \"Guaranteed by Credit Card\"\r\n                    },\r\n                    \"roomNumberLocked\": false,\r\n                    \"printRate\": false\r\n                },\r\n                \"reservationGuests\": {\r\n                    \"profileInfo\": {\r\n                        \"profileIdList\": {\r\n                            \"id\": {{ProfileId}},\r\n                            \"type\": \"Profile\"\r\n                        }\r\n                    }\r\n                },\r\n               \"reservationPaymentMethods\": [\r\n                    {\r\n                        \"paymentCard\": {\r\n                            \"cardType\": \"{{CardType}}\",\r\n                            \"cardNumber\": \"{{PaymentToken}}\",\r\n                            \"cardNumberMasked\": \"XXXXXXXXXXXX{{Last4Digits}}\",\r\n                            \"expirationDate\": \"20{{ExpiryYY-MM}}-00\",\r\n                            \"cardHolderName\": \"{{NameOnCard}}\",\r\n                            \"cardOrToken\": \"Token\",\r\n                            \"processing\": \"Manual\",\r\n                            \"swiped\": false,\r\n                            \"citId\": {{citId}}\r\n                        },\r\n                        \"authorizationRule\": {\r\n                            \"code\": \"2\" //Authorise amount for stay or deposit\r\n                        },\r\n                        \"paymentMethod\": \"{{CardType}}\",\r\n                        \"description\": \"Card token\",\r\n                        \"folioView\": \"1\"\r\n                    }\r\n                ],\r\n                \"hotelId\": \"{{HotelId}}\",\r\n                \"roomStayReservation\": true,\r\n                \"reservationStatus\": \"Reserved\",\r\n                \"computedReservationStatus\": \"DueIn\",\r\n                \"walkIn\": false,\r\n                \"printRate\": false,\r\n                \"preRegistered\": false,\r\n                \"upgradeEligible\": false,\r\n                \"allowAutoCheckin\": false,\r\n                \"hasOpenFolio\": false,\r\n                \"allowMobileCheckout\": false,\r\n                \"allowMobileViewFolio\": false,\r\n                \"allowPreRegistration\": false,\r\n                \"optedForCommunication\": false\r\n            }\r\n        ]\r\n    }\r\n}",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "https://{{HostName}}/rsv/v1/hotels/{{HotelId}}/reservations",
													"protocol": "https",
													"host": [
														"{{HostName}}"
													],
													"path": [
														"rsv",
														"v1",
														"hotels",
														"{{HotelId}}",
														"reservations"
													]
												},
												"description": "Context:  \nohip.property.createReservationWithTokenAndProfileId"
											},
											"response": []
										},
										{
											"name": "Get Reservation",
											"protocolProfileBehavior": {
												"disableBodyPruning": true
											},
											"request": {
												"auth": {
													"type": "bearer",
													"bearer": [
														{
															"key": "token",
															"value": "{{Token}}",
															"type": "string"
														}
													]
												},
												"method": "GET",
												"header": [
													{
														"key": "Content-Type",
														"value": "application/json",
														"type": "text"
													},
													{
														"key": "x-hotelid",
														"value": "{{HotelId}}",
														"type": "text"
													},
													{
														"key": "x-app-key",
														"value": "{{AppKey}}",
														"type": "text"
													}
												],
												"body": {
													"mode": "raw",
													"raw": "",
													"options": {
														"raw": {
															"language": "json"
														}
													}
												},
												"url": {
													"raw": "https://{{HostName}}/rsv/v1/hotels/{{HotelId}}/reservations/{{ReservationId}}?fetchInstructions=Reservation&fetchInstructions=RevenuesAndBalances&fetchInstructions=Packages&fetchInstructions=Preferences&fetchInstructions=LinkedReservations&fetchInstructions=Shares",
													"protocol": "https",
													"host": [
														"{{HostName}}"
													],
													"path": [
														"rsv",
														"v1",
														"hotels",
														"{{HotelId}}",
														"reservations",
														"{{ReservationId}}"
													],
													"query": [
														{
															"key": "fetchInstructions",
															"value": "Reservation"
														},
														{
															"key": "fetchInstructions",
															"value": "Comments",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "GuestMemberships",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "GuestLastStay",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ProfileAwards",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ScheduledActivities",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ServiceRequests",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ReservationAwards",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "RevenuesAndBalances"
														},
														{
															"key": "fetchInstructions",
															"value": "Tickets",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "GuestComments",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "Packages"
														},
														{
															"key": "fetchInstructions",
															"value": "InventoryItems",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ReservationPaymentMethods",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "RoutingInstructions",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "Preferences"
														},
														{
															"key": "fetchInstructions",
															"value": "Memberships",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "Alerts",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "Traces",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ConfirmationLetters",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "CallHistory",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "FixedCharges",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "GuestMessages",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ReservationPolicies",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "Indicators",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "LinkedReservations"
														},
														{
															"key": "fetchInstructions",
															"value": "ECoupons",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "TrackItItems",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "WebRegistrationCards",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ServiceRequests",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ReservationActivities",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "PrepaidCards",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "Shares"
														},
														{
															"key": "fetchInstructions",
															"value": "Attachments",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "Locators",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "TransactionDiversions",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "ECertificates",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "UpsellInfo",
															"disabled": true
														},
														{
															"key": "fetchInstructions",
															"value": "RoomAssignedByAI",
															"disabled": true
														}
													]
												},
												"description": "Context:\n\nohip.property.getReservationById"
											},
											"response": []
										}
									]
								}
							]
						},
						{
							"name": "Pay By Link",
							"item": [
								{
									"name": "Create Payment Link",
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-API-key",
												"value": "{{Adyen-AppKey}}"
											},
											{
												"key": "content-type",
												"value": "application/json"
											},
											{
												"key": "Idempotency-Key",
												"value": "{{IdempotencyKey}}",
												"type": "text",
												"disabled": true
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"reference\": \"{{PaymentReference}}\",\n    \"amount\": {\n        \"value\": {{PaymentAmount}},\n        \"currency\": \"{{CurrencyCode}}\"\n    },\n    \"description\": \"{{PurchaseDescription}}\",\n    \"countryCode\": \"{{CountryCode}}\",\n    \"merchantAccount\": \"{{Adyen-MerchantAccount}}\",\n    \"shopperLocale\": \"{{Locale}}\",\n    \"shopperReference\": \"{{Adyen-ShopperReference}}\",\n    \"storePaymentMethodMode\": \"enabled\",\n    \"recurringProcessingModel\": \"CardOnFile\",\n    \"requiredShopperFields\": [\"shopperName\", \"shopperEmail\", \"telephoneNumber\", \"billingAddress\"]\n}"
										},
										"url": {
											"raw": "{{Adyen-HostName}}/v70/paymentLinks",
											"host": [
												"{{Adyen-HostName}}"
											],
											"path": [
												"v70",
												"paymentLinks"
											]
										},
										"description": "Context:\n\nohip.payments.adyen.createPayByLink"
									},
									"response": []
								},
								{
									"name": "Get Pay By Link Details",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-API-key",
												"value": "{{Adyen-AppKey}}"
											},
											{
												"key": "content-type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": ""
										},
										"url": {
											"raw": "{{Adyen-HostName}}/v70/paymentLinks/{{PaymentId}}",
											"host": [
												"{{Adyen-HostName}}"
											],
											"path": [
												"v70",
												"paymentLinks",
												"{{PaymentId}}"
											]
										},
										"description": "Context:\n\nohip.payments.adyen.getPayByLinkDetails"
									},
									"response": []
								},
								{
									"name": "Get Payment Token",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "content-type",
												"value": "application/json"
											},
											{
												"key": "x-API-key",
												"value": "{{Adyen-AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": ""
										},
										"url": {
											"raw": "{{Adyen-HostName}}/v70/storedPaymentMethods?merchantAccount={{Adyen-MerchantAccount}}&shopperReference={{Adyen-ShopperReference}}",
											"host": [
												"{{Adyen-HostName}}"
											],
											"path": [
												"v70",
												"storedPaymentMethods"
											],
											"query": [
												{
													"key": "merchantAccount",
													"value": "{{Adyen-MerchantAccount}}"
												},
												{
													"key": "shopperReference",
													"value": "{{Adyen-ShopperReference}}"
												}
											]
										},
										"description": "Context:\n\nohip.payments.adyen.getPaymentToken"
									},
									"response": []
								},
								{
									"name": "Payment Event Hook",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{polyApiKey}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											},
											{
												"key": "Accept",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"name\": \"paymentEventHook\",\n    \"context\": \"ohip.payments.adyen\",\n    \"subpath\": \"paymentEvent\",\n    \"method\": \"POST\",\n    \"description\": \"Handle a payment event generated by Adyen platform after a guest has made a payment\",\n    \"eventPayload\": {\n        \"live\": \"false\",\n        \"notificationItems\": [\n            {\n                \"NotificationRequestItem\": {\n                    \"additionalData\": {\n                        \"fraudCheck-25-CVCAuthResultCheck\": \"0\",\n                        \"fraudCheck-72-TransactionTimeCheck\": \"0\",\n                        \"shopperCountry\": \"GB\",\n                        \"refusalReasonRaw\": \"AUTHORISED\",\n                        \"eci\": \"N/A\",\n                        \"fraudCheck-29-LiabilityShiftCheck\": \"1\",\n                        \"acquirerAccountCode\": \"TestPmmAcquirerAccount\",\n                        \"fraudCheck-63-TransactionAmountCheck\": \"0\",\n                        \"fraudCheck-8-ShopperEmailUsage\": \"0\",\n                        \"fraudCheck-64-TransactionAmountVelocity\": \"0\",\n                        \"xid\": \"N/A\",\n                        \"recurring.recurringDetailReference\": \"VM4HGSFFV6KXWD82\",\n                        \"recurringProcessingModel\": \"CardOnFile\",\n                        \"threeDAuthenticated\": \"false\",\n                        \"paymentMethodVariant\": \"visacorporatecredit\",\n                        \"fraudCheck-2-CardChunkUsage\": \"0\",\n                        \"issuerBin\": \"44443333\",\n                        \"billingAddress.country\": \"GB\",\n                        \"fraudCheck-54-DistinctSharedPaymentDetailUsageByShopper\": \"0\",\n                        \"fraudCheck-77-EmailSyntaxCheck\": \"0\",\n                        \"fraudManualReview\": \"false\",\n                        \"threeDOffered\": \"false\",\n                        \"fraudCheck-3-PaymentDetailUsage\": \"0\",\n                        \"threeDOfferedResponse\": \"N/A\",\n                        \"shopperEmail\": \"harry.potter@oracle.com\",\n                        \"authorisationMid\": \"50\",\n                        \"checkout.cardAddedBrand\": \"visacorporatecredit\",\n                        \"fraudCheck-7-ShopperIpUsage\": \"0\",\n                        \"cavv\": \"N/A\",\n                        \"fraudCheck-46-DistinctCountryUsageByShopper\": \"0\",\n                        \"shopperTelephone\": \"+447575333444\",\n                        \"authorisedAmountCurrency\": \"USD\",\n                        \"threeDAuthenticatedResponse\": \"N/A\",\n                        \"opi.transToken\": \"0009B3648tm4fsVM4HGSFFV6KXWD82\",\n                        \"threeds2.cardEnrolled\": \"false\",\n                        \"fraudCheck-53-DistinctSharedShopperIpUsageByShopper\": \"0\",\n                        \"avsResultRaw\": \"2\",\n                        \"retry.attempt1.rawResponse\": \"AUTHORISED\",\n                        \"paymentMethod\": \"visa\",\n                        \"recurring.shopperReference\": \"B676384968170222\",\n                        \"shopperLocale\": \"en-UK\",\n                        \"shopperReference\": \"B676384968170222\",\n                        \"avsResult\": \"2 Neither postal code nor address match\",\n                        \"fraudCheck-74-EmailNameCheck\": \"0\",\n                        \"fraudCheck-9-ShopperIpIssuingCountry\": \"0\",\n                        \"cardSummary\": \"1111\",\n                        \"retry.attempt1.avsResultRaw\": \"2\",\n                        \"networkTxReference\": \"940357112180561\",\n                        \"shopperIP\": \"86.179.215.162\",\n                        \"totalFraudScore\": \"1\",\n                        \"hmacSignature\": \"2ngxJCMlRyTnRCwv9ElydeH3HV7Y87d5y0hX8OpkdfU=\",\n                        \"expiryDate\": \"03/2030\",\n                        \"fraudCheck-15-IssuingCountryReferral\": \"0\",\n                        \"billingAddress.street\": \"Privet Drive\",\n                        \"shopperName\": \"[first name=Harry, infix=null, last name=Potter, gender=null]\",\n                        \"cavvAlgorithm\": \"N/A\",\n                        \"fraudCheck-37-ShopperDetailsUsage\": \"0\",\n                        \"cardBin\": \"444433\",\n                        \"billingAddress.city\": \"Surrey\",\n                        \"cvcResultRaw\": \"M\",\n                        \"fraudCheck-4-HolderNameUsage\": \"0\",\n                        \"fraudCheck-51-DistinctShopperReferenceUsageByShopper\": \"0\",\n                        \"merchantReference\": \"REF12345910\",\n                        \"acquirerReference\": \"DK2WKFXF62B\",\n                        \"fraudCheck-10-HolderNameContainsNumber\": \"0\",\n                        \"cardIssuingCountry\": \"GB\",\n                        \"liabilityShift\": \"false\",\n                        \"fraudResultType\": \"GREEN\",\n                        \"authCode\": \"049697\",\n                        \"paymentLinkId\": \"PL3B3DE5F66B44B6EB\",\n                        \"cardHolderName\": \"H Potter\",\n                        \"isCardCommercial\": \"unknown\",\n                        \"PaymentAccountReference\": \"qP5m5XVdzWl3F2EdJ5Iqkw3M8ni6Y\",\n                        \"retry.attempt1.acquirerAccount\": \"TestPmmAcquirerAccount\",\n                        \"retry.attempt1.acquirer\": \"TestPmmAcquirer\",\n                        \"fraudCheck-78-ShopperBehaviorCheck\": \"0\",\n                        \"billingAddress.houseNumberOrName\": \"4\",\n                        \"billingAddress.stateOrProvince\": \"N/A\",\n                        \"authorisedAmountValue\": \"10\",\n                        \"billingAddress.postalCode\": \"GU01 4HP\",\n                        \"fraudCheck-11-HolderNameIsOneWord\": \"0\",\n                        \"issuerCountry\": \"GB\",\n                        \"cvcResult\": \"1 Matches\",\n                        \"retry.attempt1.responseCode\": \"Approved\",\n                        \"fraudCheck-71-LoyalShopperTrustCheck\": \"0\",\n                        \"fraudCheck-1-PaymentDetailRefCheck\": \"0\",\n                        \"retry.attempt1.shopperInteraction\": \"Ecommerce\",\n                        \"cardPaymentMethod\": \"visacorporatecredit\",\n                        \"acquirerCode\": \"TestPmmAcquirer\"\n                    },\n                    \"amount\": {\n                        \"currency\": \"USD\",\n                        \"value\": 10\n                    },\n                    \"eventCode\": \"AUTHORISATION\",\n                    \"eventDate\": \"2023-09-09T09:52:12+02:00\",\n                    \"merchantAccountCode\": \"Oracle097ECOM\",\n                    \"merchantReference\": \"REF12345910\",\n                    \"operations\": [\n                        \"CANCEL\",\n                        \"CAPTURE\",\n                        \"REFUND\"\n                    ],\n                    \"paymentMethod\": \"visa\",\n                    \"pspReference\": \"Z9B4DPGGHVTFWR82\",\n                    \"reason\": \"049697:1111:03/2030\",\n                    \"success\": \"true\"\n                }\n            }\n        ]\n    },\n    \"responseStatusCode\": \"201\",\n    \"securityFunctions\": []\n}",
											"options": {
												"raw": {
													"headerFamily": "json",
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{Poly-Host}}/webhooks/",
											"host": [
												"{{Poly-Host}}"
											],
											"path": [
												"webhooks",
												""
											]
										},
										"description": "Context:\n\nohip.payments.adyen.paymentEventHook"
									},
									"response": []
								}
							]
						},
						{
							"name": "Check In",
							"item": [
								{
									"name": "Get Reservation Details by Confirmation Number",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/rsv/v1/hotels/{{HotelId}}/reservations?fetchInstructions=Reservation&confirmationNumberList={{ConfirmationNumber}}",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"rsv",
												"v1",
												"hotels",
												"{{HotelId}}",
												"reservations"
											],
											"query": [
												{
													"key": "fetchInstructions",
													"value": "Reservation"
												},
												{
													"key": "fetchInstructions",
													"value": "MasterInfo",
													"disabled": true
												},
												{
													"key": "fetchInstructions",
													"value": "RevenuesAndBalances",
													"disabled": true
												},
												{
													"key": "fetchInstructions",
													"value": null,
													"disabled": true
												},
												{
													"key": "confirmationNumberList",
													"value": "{{ConfirmationNumber}}"
												}
											]
										},
										"description": "Context:  \nohip.property.getReservationByConfirmationNumber"
									},
									"response": []
								},
								{
									"name": "Get Property Business Date",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/bof/v1/hotels/{{HotelId}}/businessDate",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"bof",
												"v1",
												"hotels",
												"{{HotelId}}",
												"businessDate"
											]
										},
										"description": "Context:\n\nohip.property.getBusinessDate"
									},
									"response": []
								},
								{
									"name": "Pre-Register Reservation with Arrival Time",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"reservation\": {\n        \"reservationId\": {\n            \"type\": \"Reservation\"\n        },\n        \"preCheckInDetails\": {\n            \"arrival\": {\n                \"arrivalTime\": \"{{ArrivalTime}}\"\n            }\n        }\n    }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/rsv/v1/hotels/{{HotelId}}/reservations/{{ReservationId}}/preCheckIn",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"rsv",
												"v1",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"preCheckIn"
											]
										},
										"description": "Context:\n\nohip.property.preCheckIn"
									},
									"response": []
								},
								{
									"name": "Search Available Room",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/fof/v1/hotels/{{HotelId}}/rooms?hotelRoomStartDate={{DateFrom}}&hotelRoomEndDate={{DateTo}}&hotelRoomStatus=Inspected&hotelRoomFrontOfficeStatus=Vacant&roomType={{RoomTypeCode}}",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"fof",
												"v1",
												"hotels",
												"{{HotelId}}",
												"rooms"
											],
											"query": [
												{
													"key": "hotelRoomStartDate",
													"value": "{{DateFrom}}"
												},
												{
													"key": "hotelRoomEndDate",
													"value": "{{DateTo}}"
												},
												{
													"key": "hotelRoomStatus",
													"value": "Inspected"
												},
												{
													"key": "hotelRoomFrontOfficeStatus",
													"value": "Vacant"
												},
												{
													"key": "roomFeatureCode",
													"value": "KETTLE",
													"disabled": true
												},
												{
													"key": "roomType",
													"value": "{{RoomTypeCode}}"
												}
											]
										},
										"description": "Context:\n\nohip.property.getAvailableRooms"
									},
									"response": []
								},
								{
									"name": "Assign Room to Guest",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n    \"criteria\": {\r\n        \"hotelId\": \"{{HotelId}}\",\r\n        \"reservationIdList\": [\r\n            {\r\n                \"id\": \"{{ReservationId}}\",\r\n                \"type\": \"Reservation\"\r\n            }\r\n        ],\r\n        \"roomId\": \"{{RoomId}}\",\r\n        \"updateRoomTypeCharged\": false,\r\n        \"roomNumberLocked\": true\r\n    }\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/fof/v0/hotels/{{HotelId}}/reservations/{{ReservationId}}/roomAssignments",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"fof",
												"v0",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"roomAssignments"
											]
										},
										"description": "Context:\n\nohip.property.assignRoom"
									},
									"response": []
								},
								{
									"name": "Check In Guest",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"reservation\": {\r\n    \"roomId\": \"{{RoomId}}\",\r\n    \"ignoreWarnings\": true,\r\n    \"stopCheckin\": false,\r\n    \"printRegistration\": false\r\n  },\r\n  \"fetchReservationInstruction\": [\r\n    \"ReservationDetail\"\r\n  ],\r\n  \"includeNotifications\": true\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/fof/v1/hotels/{{HotelId}}/reservations/{{ReservationId}}/checkIns",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"fof",
												"v1",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"checkIns"
											]
										},
										"description": "Context:\n\nohip.property.checkIn"
									},
									"response": []
								}
							]
						},
						{
							"name": "During Stay",
							"item": [
								{
									"name": "Get Packages",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"url": {
											"raw": "https://{{HostName}}/rtp/v1/packages?includeGroup=true&sellSeparate=true&endDate={{DateTo}}&children={{Adults}}&adults={{Children}}&fetchInstructions=Header&fetchInstructions=CalculatedPrice&fetchInstructions=Items&hotelId={{HotelId}}&startDate={{DateFrom}}&ticketPostingRhythm=false&fetchInstructions=PostingRules",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"rtp",
												"v1",
												"packages"
											],
											"query": [
												{
													"key": "includeGroup",
													"value": "true"
												},
												{
													"key": "sellSeparate",
													"value": "true"
												},
												{
													"key": "endDate",
													"value": "{{DateTo}}"
												},
												{
													"key": "children",
													"value": "{{Adults}}"
												},
												{
													"key": "adults",
													"value": "{{Children}}"
												},
												{
													"key": "fetchInstructions",
													"value": "Header"
												},
												{
													"key": "fetchInstructions",
													"value": "CalculatedPrice"
												},
												{
													"key": "fetchInstructions",
													"value": "Items"
												},
												{
													"key": "hotelId",
													"value": "{{HotelId}}"
												},
												{
													"key": "startDate",
													"value": "{{DateFrom}}"
												},
												{
													"key": "ticketPostingRhythm",
													"value": "false"
												},
												{
													"key": "fetchInstructions",
													"value": "PostingRules"
												}
											]
										},
										"description": "Context:\n\nohip.property.getPackages"
									},
									"response": []
								},
								{
									"name": "Get Transaction Codes",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/csh/v0/hotels/{{HotelId}}/transactionCodes?includeArticles=true",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"csh",
												"v0",
												"hotels",
												"{{HotelId}}",
												"transactionCodes"
											],
											"query": [
												{
													"key": "includeArticles",
													"value": "true"
												},
												{
													"key": "userRoleTransactions",
													"value": "",
													"disabled": true
												},
												{
													"key": "manualPostAllowed",
													"value": "true",
													"disabled": true
												},
												{
													"key": "code",
													"value": "",
													"disabled": true
												},
												{
													"key": "description",
													"value": "",
													"disabled": true
												},
												{
													"key": "wildCard",
													"value": "",
													"disabled": true
												},
												{
													"key": "folioDate",
													"value": "",
													"disabled": true
												},
												{
													"key": "folioNo",
													"value": "",
													"disabled": true
												},
												{
													"key": "folioStatus",
													"value": "",
													"disabled": true
												},
												{
													"key": "folioTypeName",
													"value": "",
													"disabled": true
												},
												{
													"key": "invoiceNo",
													"value": "",
													"disabled": true
												}
											]
										},
										"description": "Context:\n\nohip.property.getTransactionCodes"
									},
									"response": []
								},
								{
									"name": "Add Charges",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n    \"criteria\": {\r\n        \"charges\": {\r\n            \"postingQuantity\": 1,\r\n            \"usePackageAllowance\": false,\r\n            \"price\": {\r\n                \"amount\": {{PackageAmount}},\r\n                \"currencyCode\": {{CurrencyCode}}\r\n            },\r\n            \"transactionCode\": {{TransactionCode}},\r\n            \"applyRoutingInstructions\": false\r\n        },\r\n        \"reservationId\": {\r\n            \"idContext\": \"OPERA\",\r\n            \"id\": {{ReservationId}},\r\n            \"type\": \"Reservation\"\r\n        },\r\n        \"cashierId\": 1,\r\n        \"hotelId\": \"{{HotelId}}\",\r\n        \"postIt\": false\r\n    }\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/csh/v1/hotels/{{HotelId}}/reservations/{{ReservationId}}/charges",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"csh",
												"v1",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"charges"
											]
										},
										"description": "Context:\n\nohip.property.addCharges"
									},
									"response": []
								},
								{
									"name": "Get the Guest Folio",
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/csh/v0/hotels/{{HotelId}}/reservations/{{ReservationId}}/folios?folioWindowNo=1&limit=50&fetchInstructions=Postings&fetchInstructions=Totalbalance&fetchInstructions=Transactioncodes&fetchInstructions=Windowbalances",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"csh",
												"v0",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"folios"
											],
											"query": [
												{
													"key": "folioWindowNo",
													"value": "1"
												},
												{
													"key": "limit",
													"value": "50"
												},
												{
													"key": "fetchInstructions",
													"value": "Account",
													"disabled": true
												},
												{
													"key": "fetchInstructions",
													"value": "Postings"
												},
												{
													"key": "fetchInstructions",
													"value": "Totalbalance"
												},
												{
													"key": "fetchInstructions",
													"value": "Transactioncodes"
												},
												{
													"key": "fetchInstructions",
													"value": "Windowbalances"
												},
												{
													"key": "fetchInstructions",
													"value": "Payment",
													"disabled": true
												},
												{
													"key": "fetchInstructions",
													"value": "Reservation",
													"disabled": true
												},
												{
													"key": "fetchInstructions",
													"value": "Payee",
													"disabled": true
												},
												{
													"key": "guestPayOnly",
													"value": "Y",
													"disabled": true
												},
												{
													"key": "reservationBalanceOnly",
													"value": "false",
													"disabled": true
												},
												{
													"key": "includeFolioHistory",
													"value": "false",
													"disabled": true
												}
											]
										},
										"description": "Context:\n\nohip.property.getFolioDetails"
									},
									"response": []
								}
							]
						},
						{
							"name": "Check Out",
							"item": [
								{
									"name": "Pay The Folio",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n    \"criteria\": {\r\n        \"overrideInsufficientCC\": false,\r\n        \"applyCCSurcharge\": false,\r\n        \"vATOffset\": false,\r\n        \"reservationId\": {\r\n            \"idContext\": \"OPERA\",\r\n            \"id\": {{ReservationId}},\r\n            \"type\": \"Reservation\"\r\n        },\r\n        \"paymentMethod\": {\r\n            \"paymentMethod\": \"CA\"\r\n        },\r\n        \"postingReference\": \"{{PostingReference}}\",\r\n        \"postingAmount\": {\r\n            \"amount\": {{PaymentAmount}},\r\n            \"currencyCode\": \"{{CurrencyCode}}\"\r\n        },\r\n        \"cashierId\": {{CashierId}},\r\n        \"hotelId\": \"{{HotelId}}\",\r\n        \"folioWindowNo\": {{FolioWindow}},\r\n        \"overrideARCreditLimit\": false\r\n    }\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/csh/v0/hotels/{{HotelId}}/reservations/{{ReservationId}}/payments",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"csh",
												"v0",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"payments"
											]
										},
										"description": "Context:\n\nohip.property.settleFolio"
									},
									"response": []
								},
								{
									"name": "Prepare Folio for Check Out",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n    \"criteria\": {\r\n        \"reservationId\": {\r\n            \"idContext\": \"OPERA\",\r\n            \"id\": {{ReservationId}},\r\n            \"type\": \"Reservation\"\r\n        },\r\n        \"profileId\": {\r\n            \"idContext\": \"OPERA\",\r\n            \"id\": {{ProfileId}},\r\n            \"type\": \"Profile\"\r\n        },\r\n        \"fiscalFolioInstruction\": \"New\",\r\n        \"allFolioWindow\": false,\r\n        \"folioQueue\": {\r\n            \"generateFiscalFolio\": false\r\n        },\r\n        \"cashierId\": 1,\r\n        \"hotelId\": \"{{HotelId}}\",\r\n        \"eventType\": \"CheckOut\",\r\n        \"folioWindowNo\": 1,\r\n        \"correction\": false,\r\n        \"debitFolio\": false\r\n    }\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/csh/v0/hotels/{{HotelId}}/reservations/{{ReservationId}}/folios",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"csh",
												"v0",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"folios"
											],
											"query": [
												{
													"key": null,
													"value": "",
													"disabled": true
												}
											]
										},
										"description": "Context:\n\nohip.property.createFolio"
									},
									"response": []
								},
								{
									"name": "Check Out Guest",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n    \"reservation\": {\r\n        \"reservationIdList\": {\r\n            \"id\": {{ReservationId}},\r\n            \"type\": \"Reservation\"\r\n        },\r\n        \"stopCheckout\": false,\r\n        \"cashierId\": 1,\r\n        \"hotelId\": \"{{HotelId}}\",\r\n        \"eventType\": \"CheckOut\",\r\n        \"autoCheckout\": false,\r\n        \"checkoutInstr\": {\r\n            \"roomStatus\": \"Dirty\",\r\n            \"ignoreWarnings\": true\r\n        }\r\n    },\r\n    \"verificationOnly\": false\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/csh/v0/hotels/{{HotelId}}/reservations/{{ReservationId}}/checkOuts",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"csh",
												"v0",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"checkOuts"
											]
										},
										"description": "Context:\n\nohip.property.checkout"
									},
									"response": []
								},
								{
									"name": "Reverse Check Out",
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{Token}}",
													"type": "string"
												}
											]
										},
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json",
												"type": "text"
											},
											{
												"key": "x-hotelid",
												"value": "{{HotelId}}",
												"type": "text"
											},
											{
												"key": "x-app-key",
												"value": "{{AppKey}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n    \"reservationId\": {\r\n        \"idContext\": \"OPERA\",\r\n        \"id\": {{ReservationId}},\r\n        \"type\": \"Reservation\"\r\n    },\r\n    \"notifyInterfaces\": true,\r\n    \"overrideFlag\": false,\r\n    \"cashierId\": 1\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "https://{{HostName}}/csh/v0/hotels/{{HotelId}}/reservations/{{ReservationId}}/checkOuts/reinstate",
											"protocol": "https",
											"host": [
												"{{HostName}}"
											],
											"path": [
												"csh",
												"v0",
												"hotels",
												"{{HotelId}}",
												"reservations",
												"{{ReservationId}}",
												"checkOuts",
												"reinstate"
											]
										},
										"description": "Context:\n\nohip.property.reinstateCheckout"
									},
									"response": []
								}
							],
							"description": "This workflow provides a suggested set of operations to use in order to check out the guest, as well as including posting charges, making payments viewing folio details.\n\n## Check out a Guest\n\n1. Retrieve Reservation\n2. get Folio details\n3. post billing charge\n4. post billing payment\n5. Check Out Guest\n\n| **Business case** | **Rest api** | **Module** |\n| --- | --- | --- |\n| **Retrieve a reservation –** if you know the reservation Id use getReservation. If you need to search for a reservation with names, room number, arrival date, etc use `getReservations`. | getReservations getReservation | Reservations (RSV) |\n| **Get the folio details**. This will return you information on the guests account (folio) and will advise the charges, payments and outstanding balances. | getFolios | Cashiering (CSH) |\n| **Post a charge** to a guest's reservation/folio. For example a guest had chips from the mini bar, you can add this charge to their folio.  In order to know the charges that can be posted, use `getTransactionCodes` operation. | postBillingCharges getTransactionCodes | Cashiering (CSH) |\n| **Post a payment** to the folio. From the folio details you will be able to see the balance for the guest's stay. You can post a payment to the folio using this operation to bring the balance to $0. | postBillingPayments | Cashiering (CSH) |\n| **Generate Folio Number.** This operation is required once you have brought the folio balance to $0 and is used to generate the folio number and/or bill number. Use postFolios to perform this action. | postFolios | Cashiering (CSH) |\n| **Check out a reservation**. Typically you will only be able to check out a guest if their folio balance is $0. | postCheckOuts | Cashiering (CSH) |",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							]
						}
					]
				},
				{
					"name": "HTNG Express",
					"item": [
						{
							"name": "Get Profile By Id",
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{Token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "x-app-key",
										"value": "{{AppKey}}",
										"type": "text"
									},
									{
										"key": "x-hotelid",
										"value": "{{HotelId}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "https://{{HostName}}/crm/v1/profiles/{{ProfileId}}?fetchInstructions=Communication&fetchInstructions=Address&fetchInstructions=Membership&fetchInstructions=Preference&fetchInstructions=Profile&fetchInstructions=Correspondence",
									"protocol": "https",
									"host": [
										"{{HostName}}"
									],
									"path": [
										"crm",
										"v1",
										"profiles",
										"{{ProfileId}}"
									],
									"query": [
										{
											"key": "fetchInstructions",
											"value": "Communication"
										},
										{
											"key": "fetchInstructions",
											"value": "Address"
										},
										{
											"key": "fetchInstructions",
											"value": "Comment",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "DeliveryMethods",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "FutureReservation",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "GdsNegotiatedRate",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "HistoryReservation",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "Indicators",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "Keyword",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "Membership"
										},
										{
											"key": "fetchInstructions",
											"value": "NegotiatedRate",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "Preference"
										},
										{
											"key": "fetchInstructions",
											"value": "Profile"
										},
										{
											"key": "fetchInstructions",
											"value": "Relationship",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "SalesInfo",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "Subscriptions",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "WebUserAccount",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "Correspondence"
										}
									]
								},
								"description": "Context:\n\nohip.property.getProfileById"
							},
							"response": []
						},
						{
							"name": "Get Property Reservation with External Id",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{Token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "x-hotelId",
										"value": "{{HotelId}}",
										"type": "text"
									},
									{
										"key": "x-app-key",
										"value": "{{AppKey}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "https://{{HostName}}/rsv/v1/hotels/{{HotelId}}/reservations?externalReferenceIds={{ExternalReservationId}}",
									"protocol": "https",
									"host": [
										"{{HostName}}"
									],
									"path": [
										"rsv",
										"v1",
										"hotels",
										"{{HotelId}}",
										"reservations"
									],
									"query": [
										{
											"key": "externalReferenceIds",
											"value": "{{ExternalReservationId}}"
										}
									]
								},
								"description": "Context:\n\nohip.property.getReservationByExternalId"
							},
							"response": []
						},
						{
							"name": "Search Reservations By Arrival Departure Dates And Guest Names",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{Token}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"type": "text"
									},
									{
										"key": "x-app-key",
										"value": "{{AppKey}}",
										"type": "text"
									},
									{
										"key": "x-hotelid",
										"value": "{{HotelId}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "https://{{HostName}}/rsv/v1/hotels/{{HotelId}}/reservations?limit=200&fetchInstructions=Reservation&arrivalStartDate={{ArrivalDateFrom}}&arrivalEndDate={{ArrivalDateTo}}&departureStartDate={{DepartureDateFrom}}&departureEndDate={{DepartureDateTo}}&orderBy={{OrderBy}}&sortOrder={{SortOrder}}&surname={{GuestLastName}}&names={{GuestFirstName}}",
									"protocol": "https",
									"host": [
										"{{HostName}}"
									],
									"path": [
										"rsv",
										"v1",
										"hotels",
										"{{HotelId}}",
										"reservations"
									],
									"query": [
										{
											"key": "limit",
											"value": "200"
										},
										{
											"key": "offset",
											"value": "",
											"disabled": true
										},
										{
											"key": "fetchInstructions",
											"value": "Reservation"
										},
										{
											"key": "arrivalStartDate",
											"value": "{{ArrivalDateFrom}}"
										},
										{
											"key": "arrivalEndDate",
											"value": "{{ArrivalDateTo}}"
										},
										{
											"key": "departureStartDate",
											"value": "{{DepartureDateFrom}}"
										},
										{
											"key": "departureEndDate",
											"value": "{{DepartureDateTo}}"
										},
										{
											"key": "createdOnStartDate",
											"value": "{{CreatedOn}}",
											"disabled": true
										},
										{
											"key": "orderBy",
											"value": "{{OrderBy}}",
											"description": "Room|GuestSurname|ArrivalDate|DepartureDate"
										},
										{
											"key": "sortOrder",
											"value": "{{SortOrder}}",
											"description": "ASC|DESC"
										},
										{
											"key": "surname",
											"value": "{{GuestLastName}}"
										},
										{
											"key": "names",
											"value": "{{GuestFirstName}}"
										},
										{
											"key": "roomRangeFrom",
											"value": "{{RoomNumberFrom}}",
											"disabled": true
										},
										{
											"key": "roomRangeTo",
											"value": "{{RoomNumberTo}}",
											"disabled": true
										},
										{
											"key": "roomId",
											"value": "{{RoomId}}",
											"disabled": true
										}
									]
								},
								"description": "Context.\n\nohip.property.searchReservationsByDateRangeAndGuestNames"
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "Train",
			"item": [],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"requests": {},
						"exec": [
							"const { headers, body, auth, url } = pm.request;",
							"",
							"pm.environment.set('templateHeaders', headers);",
							"pm.environment.set('templateBody', body);",
							"pm.environment.set('templateAuth', auth);",
							"pm.environment.set('templateUrl', url);",
							"",
							"const polyHost = pm.environment.get('Poly-Host');",
							"const apiKey = pm.environment.get('polyApiKey');",
							"",
							"pm.environment.set('polyData', {",
							"    hostUrl: polyHost,",
							"    polyApiKey: apiKey",
							"    // ,id: 'aef32f3c-93b4-460b-8da8-71d572cd66ed'",
							"});",
							"",
							"/*",
							"    You can use code snippets bellow in specific requests to change Poly behavior when training.",
							"    WARNING: Don't use them in collection pre-request and/or post-request, if you use them in collection level they will affect all requests",
							"    inside collection.",
							"*/",
							"",
							"/**",
							" * To set api context, description and/or name you can do:",
							" * pm.environment.set('polyData', {",
							" *   hostUrl: 'https://eu1.polyapi.io',",
							" *   polyApiKey: 'YourApiKeyHere',",
							" *   description: 'lorem ipsum...',",
							" *   name: 'createPost',",
							" *   context: 'jsonplaceholder",
							" * });",
							" */",
							"",
							"/**",
							" * To set response payload path you can do:",
							" * pm.environment.set('polyData', {",
							" *   hostUrl: 'https://eu1.polyapi.io',",
							" *   polyApiKey: 'YourApiKeyHere',",
							" *   payload: '$.results[0].geometry.location'",
							" * });",
							" */",
							"",
							"/**",
							" * To explicitly create a new api function and skip retraining rules, pass { id: 'new' } to polyData environment variable:",
							" * pm.environment.set('polyData', {",
							" *   hostUrl: 'https://eu1.polyapi.io',",
							" *   polyApiKey: 'YourApiKeyHere',",
							" *   id: 'new'",
							" * });",
							" */",
							"",
							"/**",
							" * To explicitly override a saved api function, pass { id: string } with api function id to polyData environment variable:",
							" * pm.environment.set('polyData', {",
							" *   hostUrl: 'https://eu1.polyapi.io',",
							" *   polyApiKey: 'YourApiKeyHere',",
							" *   id: '2915f8c3-1740-4d3b-8165-510d4089c580'",
							" * });",
							" */",
							"",
							"",
							"/**",
							" * For graphql functions, variable types are inferred from graphql introspection call by default. If you want to infer them from",
							" * Postman's graphql variables, you can pass:",
							" * pm.environment.set('polyData', {",
							" *   hostUrl: 'https://eu1.polyapi.io',",
							" *   polyApiKey: 'YourApiKeyHere',",
							" *   inferArgTypesFromPostmanGraphqlVariables: true",
							" * });",
							" * This can be useful for custom scalar types since by default are typed as string | number | boolean | object | array. This is because",
							" * graphql doesn't give information about custom scalar types when introspecting, so, a custom scalar type can be `any` value.",
							" */"
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"requests": {},
						"exec": [
							"const postmanCollection = require('postman-collection');",
							"",
							"const scriptVersion = '0.4.4'; // increased minor version",
							"const { polyApiKey: apiKey, hostUrl, ...polyData } = pm.environment.get('polyData') || {};",
							"const { method, description, url, body } = pm.request;",
							"",
							"const templateBody = new postmanCollection.RequestBody(pm.environment.get('templateBody'));",
							"const templateHeaders = new postmanCollection.HeaderList(null, pm.environment.get('templateHeaders'));",
							"const templateAuth = new postmanCollection.RequestAuth(pm.environment.get('templateAuth'));",
							"const templateUrl = new postmanCollection.Url(pm.environment.get('templateUrl'));",
							"",
							"const ARGUMENT_PATTERN = /(?<=\\{\\{)([^}{]+)(?=\\}\\})/g;",
							"",
							"pm.environment.unset('polyData');",
							"pm.environment.unset('polyFunctionId');",
							"",
							"pm.environment.unset('templateBody');",
							"pm.environment.unset('templateHeaders');",
							"pm.environment.unset('templateAuth');",
							"pm.environment.unset('templateUrl');",
							"",
							"let response;",
							"",
							"const responseContentType = pm.response.headers.get('content-type') || '';",
							"const responseStatusCode = pm.response.code;",
							"",
							"if (responseStatusCode === 204 || method.toLowerCase() === 'head') {",
							"  response = null;",
							"} else if (responseContentType.match(/application\\/.*json/) !== null) {",
							"  response = pm.response.json();",
							"} else {",
							"  response = pm.response.text();",
							"}",
							"",
							"const collectionVariables = pm.collectionVariables.toObject();",
							"const environmentVariables = pm.environment.toObject();",
							"",
							"let processedTemplateAuth = templateAuth;",
							"",
							"/* START-POSTMAN-SANITISATION-CODE */",
							"",
							"if (templateAuth.type === 'bearer') {",
							"  const bearerAuth = {",
							"    type: 'bearer',",
							"    bearer: [],",
							"  };",
							"",
							"  // Filter invalid bearer objects.",
							"  bearerAuth.bearer = templateAuth.bearer.filter(bearer => typeof bearer.value !== 'undefined');",
							"",
							"  const foundArgs = bearerAuth.bearer.filter(bearer => bearer.value?.match(ARGUMENT_PATTERN)).length;",
							"",
							"  if (foundArgs > 1) {",
							"    const [firstBearer, ...restBearerParts] = bearerAuth.bearer;",
							"    bearerAuth.bearer = [firstBearer, ...restBearerParts.filter(bearer => !bearer.value?.match(ARGUMENT_PATTERN))];",
							"  }",
							"",
							"  processedTemplateAuth = bearerAuth;",
							"} else if (templateAuth.type === 'basic') {",
							"  // Filter keys that are not 'username' | 'password'",
							"  const basicAuth = {",
							"    type: 'basic',",
							"    basic: templateAuth.basic.filter(entry => ['username', 'password'].includes(entry.key)),",
							"  };",
							"  processedTemplateAuth = basicAuth;",
							"} else if (templateAuth.type === 'apikey' && Array.isArray(templateAuth.apikey)) {",
							"  const keyEntry   = templateAuth.apikey.find((p) => p.key === 'key'   && typeof p.value !== 'undefined');",
							"  const valueEntry = templateAuth.apikey.find((p) => p.key === 'value' && typeof p.value !== 'undefined');",
							"  let   inEntry    = templateAuth.apikey.find((p) => p.key === 'in'    && typeof p.value !== 'undefined');",
							"",
							"  if (!inEntry) {",
							"    inEntry = { key: 'in', value: 'header', type: 'any' };",
							"  }",
							"",
							"  if (keyEntry && valueEntry) {",
							"    processedTemplateAuth = { type: 'apikey', apikey: [inEntry, keyEntry, valueEntry] };",
							"  } else {",
							"    // FIX: apikey was incomplete and backend rejects it. Normalise to noauth so validation passes.",
							"    processedTemplateAuth = { type: 'noauth' };",
							"  }",
							"} else {",
							"  // FIX: unsupported or missing auth types (oauth2, digest, undefined) caused validation error.",
							"  // Map them to noauth which backend accepts.",
							"  processedTemplateAuth = { type: 'noauth' };",
							"}",
							"",
							"if (!templateHeaders.find(h => h.key === 'Accept')) {",
							"  // Postman will add this header automatically so we add it to mirror postman behaviour",
							"  templateHeaders.add({ key: 'Accept', value: '*/*' });",
							"}",
							"if (!templateHeaders.find(h => h.key === 'Accept-Encoding')) {",
							"  // Postman will add this header automatically so we add it to mirror postman behaviour",
							"  templateHeaders.add({ key: 'Accept-Encoding', value: 'gzip, deflate, br' });",
							"}",
							"",
							"/* END-POSTMAN-SANITISATION-CODE */",
							"",
							"/* START-BODY-SANITISATION-FOR-TRAINING */",
							"",
							"function isLikelyEmpty(value) {",
							"  return value === undefined || value === null || (typeof value === 'string' && value.trim() === '');",
							"}",
							"",
							"// FIX: previously we tried to JSON.parse raw bodies to validate them.",
							"// This breaks when the body contains Postman variables like {{ChildrenAges}} which are not valid JSON before substitution.",
							"// New behaviour: for non-GET we pass through any non empty raw string as-is.",
							"// For GET or HEAD we still force { mode: 'empty' } to satisfy backend guidance.",
							"function sanitiseBodyForTraining(reqMethod, pmBodyLike) {",
							"  const m = String(reqMethod || '').toLowerCase();",
							"",
							"  // No body for GET or HEAD",
							"  if (m === 'get' || m === 'head') {",
							"    return { mode: 'empty' }; // FIX: prevents invalid JSON errors on GET or HEAD",
							"  }",
							"",
							"  if (!pmBodyLike) {",
							"    return { mode: 'empty' };",
							"  }",
							"",
							"  // Normalise to a plain object",
							"  const isPMBody = pmBodyLike instanceof postmanCollection.RequestBody;",
							"  const mode = isPMBody ? pmBodyLike.mode : pmBodyLike.mode;",
							"",
							"  if (mode === 'raw') {",
							"    // Read raw string from either RequestBody instance or plain object",
							"    const raw = isPMBody ? pmBodyLike.raw : pmBodyLike.raw;",
							"",
							"    if (isLikelyEmpty(raw)) {",
							"      return { mode: 'empty' }; // empty raw, nothing to train on",
							"    }",
							"",
							"    // FIX: do not JSON-parse here, allow Postman variables to remain in the template.",
							"    // This preserves training bodies like \"childAges\": {{ChildrenAges}} which are intended to be arrays at runtime.",
							"    return { mode: 'raw', raw: String(raw) };",
							"  }",
							"",
							"  if (mode === 'graphql') {",
							"    // GraphQL body is typically an object with {query, variables}",
							"    const graph = isPMBody ? pmBodyLike.graphql : pmBodyLike.graphql;",
							"    if (graph && typeof graph === 'object') {",
							"      return { mode: 'graphql', graphql: graph };",
							"    }",
							"    return { mode: 'empty' };",
							"  }",
							"",
							"  if (mode === 'urlencoded' && Array.isArray(isPMBody ? pmBodyLike.urlencoded : pmBodyLike.urlencoded)) {",
							"    return { mode: 'urlencoded', urlencoded: isPMBody ? pmBodyLike.urlencoded : pmBodyLike.urlencoded };",
							"  }",
							"",
							"  if (mode === 'formdata' && Array.isArray(isPMBody ? pmBodyLike.formdata : pmBodyLike.formdata)) {",
							"    return { mode: 'formdata', formdata: isPMBody ? pmBodyLike.formdata : pmBodyLike.formdata };",
							"  }",
							"",
							"  // Safe default",
							"  return { mode: 'empty' };",
							"}",
							"",
							"const trainingBody = sanitiseBodyForTraining(method, body);",
							"const sanitisedTemplateBody = sanitiseBodyForTraining(method, templateBody);",
							"",
							"/* END-BODY-SANITISATION-FOR-TRAINING */",
							"",
							"const rawObject = {",
							"  description: description?.context,",
							"  requestName: pm.info.requestName,",
							"  ...polyData,",
							"  url: url.toString(),",
							"  // FIX: use sanitised bodies. For non-GET with raw mode, this now preserves the original raw string with variables.",
							"  body: trainingBody,",
							"  templateHeaders,",
							"  method,",
							"  templateAuth: processedTemplateAuth,",
							"  responseContentType,",
							"  response,",
							"  variables: {",
							"    ...environmentVariables,",
							"    ...collectionVariables,",
							"  },",
							"  statusCode: pm.response.code,",
							"  templateUrl:`${templateUrl.protocol ? `${templateUrl.protocol}://` : ''}${templateUrl.getRemote()}${templateUrl.getPathWithQuery() !== '/' ? templateUrl.getPathWithQuery() : ''}`,",
							"  templateBody: sanitisedTemplateBody,",
							"};",
							"",
							"const postRequest = {",
							"  url: `${hostUrl}/functions/api/training/postman`,",
							"  method: 'POST',",
							"  header: {",
							"    'Content-Type': 'application/json',",
							"    'Authorization': `Bearer ${apiKey}`,",
							"    'x-poly-training-script-version': scriptVersion,",
							"  },",
							"  body: {",
							"    mode: 'raw',",
							"    raw: JSON.stringify(rawObject),",
							"  },",
							"};",
							"",
							"async function getIntrospectionData() {",
							"",
							"  const headers = pm.request.headers.all().filter(value => !['Content-Length'].includes(value.key)).reduce((acum, header) => {",
							"    const argumentPattern = /(?<=\\{\\{)([^}]+)(?=\\})/gi;",
							"    const parsedHeaderValue = header.value;",
							"    const argumentsMatch = parsedHeaderValue.match(argumentPattern);",
							"",
							"    if (argumentsMatch) {",
							"      for (const pmArg of argumentsMatch) {",
							"        const argValue = collectionVariables[pmArg] || environmentVariables[pmArg];",
							"",
							"        if (argValue) {",
							"          parsedHeaderValue.replace(`{{${pmArg}}}`, argValue);",
							"        }",
							"      }",
							"    }",
							"",
							"    return {",
							"      ...acum,",
							"      [header.key]: {",
							"        ...header,",
							"        value: parsedHeaderValue,",
							"      },",
							"    };",
							"",
							"  }, {});",
							"",
							"  const introspectionRequest = {",
							"    url: url.toString(),",
							"    method: 'POST',",
							"    header: headers,",
							"    body: {",
							"      mode: 'raw',",
							"      raw: JSON.stringify({",
							"        query: 'query IntrospectionQuery{__schema{queryType{name}mutationType{name}subscriptionType{name}types{...FullType}directives{name description locations args{...InputValue}}}}fragment FullType on __Type{kind name description fields(includeDeprecated:true){name description args{...InputValue}type{...TypeRef}isDeprecated deprecationReason}inputFields{...InputValue}interfaces{...TypeRef}enumValues(includeDeprecated:true){name description isDeprecated deprecationReason}possibleTypes{...TypeRef}}fragment InputValue on __InputValue{name description type{...TypeRef}defaultValue}fragment TypeRef on __Type{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name ofType{kind name}}}}}}}}',",
							"      }),",
							"    },",
							"  };",
							"",
							"  const response = await (new Promise((resolve, reject) => {",
							"    pm.sendRequest(introspectionRequest, (error, response) => {",
							"",
							"      if (error) {",
							"        return reject(new Error('Graphql introspection call failed.'));",
							"      }",
							"",
							"      resolve(response);",
							"",
							"    });",
							"  }));",
							"",
							"  return response.json();",
							"}",
							"",
							"function teachPoly(introspectionResponse) {",
							"  return new Promise((resolve, reject) => {",
							"    pm.sendRequest({",
							"      ...postRequest,",
							"      body: {",
							"        ...postRequest.body,",
							"        raw: introspectionResponse",
							"          ? JSON.stringify({ ...rawObject, introspectionResponse })",
							"          : JSON.stringify(rawObject),",
							"      },",
							"    }, (error, response) => {",
							"      if (error) {",
							"        return reject(error);",
							"      }",
							"      resolve(response);",
							"    });",
							"  });",
							"}",
							"",
							"(async () => {",
							"",
							"  if(typeof apiKey === 'undefined' || apiKey === 'YourApiKeyHere') {",
							"    console.error('Your key needs to be set in the pre-request script, look for line \"polyApiKey: \\'YourAPIKeyHere\\'');",
							"    return;",
							"  }",
							"",
							"  try {",
							"    console.info('Training poly function...');",
							"",
							"    let response = null;",
							"",
							"    if (body?.mode === 'graphql' && !polyData?.inferArgTypesFromPostmanGraphqlVariables) {",
							"",
							"      console.info('Introspecting api...');",
							"",
							"      const introspectionResponse = await getIntrospectionData();",
							"",
							"      if (!introspectionResponse?.data?.__schema) {",
							"        console.warn('Cannot introspect api, inferring argument types from postman graphql variables box...');",
							"      }",
							"",
							"      response = await teachPoly(introspectionResponse.data);",
							"",
							"    } else {",
							"      if(body?.mode === 'graphql') {",
							"        console.info('`inferArgTypesFromPostmanGraphqlVariables` flag activated, inferring argument types from postman graphql variables box...');",
							"      }",
							"      response = await teachPoly();",
							"    }",
							"",
							"    if (response.code >= 400) {",
							"      return console.error(`Training call failed with status code ${response.code}. Message: ${response.json()?.message}`);",
							"    }",
							"",
							"    const responseBody = await response.json();",
							"",
							"    if(responseBody.traceId) {",
							"        console.warn(`Failed to generate descriptions while training function, trace id: ${responseBody.traceId}`);",
							"    }",
							"",
							"    console.info('Function trained.');",
							"  } catch (err) {",
							"    console.error('Training of poly function failed.', err);",
							"  }",
							"})();",
							""
						]
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "hello",
			"value": "Hello"
		},
		{
			"key": "world",
			"value": "world"
		}
	]
}